<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Danh s√°ch Nh·∫≠t k√Ω</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        .emoji {
            font-size: 20px;
        }
        .stars {
            color: gold;
        }
    </style>
</head>
<body>
<section class="section">
    <div class="container">
        <h1 class="title">Nh·∫≠t k√Ω c·ªßa b·∫°n</h1>
        <a th:href="@{'/diaries/' + ${userId} + '/add'}" class="button is-primary">+ Th√™m nh·∫≠t k√Ω</a>
        <br/><br/>

        <!-- Form l·ªçc -->
        <form th:action="@{'/diaries/' + ${userId} + '/search'}" method="get" class="columns is-multiline">
            <div class="column is-3">
                <input class="input" type="text" name="keyword" placeholder="T√¨m ti√™u ƒë·ªÅ ho·∫∑c ho·∫°t ƒë·ªông..."
                       th:value="${keyword}">
            </div>
            <div class="column is-2">
                <div class="select is-fullwidth">
                    <select name="feeling">
                        <option value="">-- C·∫£m x√∫c --</option>
                        <option th:selected="${feeling == 'Y√™u th√≠ch ‚ù§Ô∏è'}">Y√™u th√≠ch ‚ù§Ô∏è</option>
                        <option th:selected="${feeling == 'R·∫•t vui üòÑ'}">R·∫•t vui üòÑ</option>
                        <option th:selected="${feeling == 'Bu·ªìn üò¢'}">Bu·ªìn üò¢</option>
                        <option th:selected="${feeling == 'Kh√¥ng vui üòê'}">Kh√¥ng vui üòê</option>
                        <option th:selected="${feeling == 'T·ªá üòû'}">T·ªá üòû</option>
                    </select>
                </div>
            </div>
            <div class="column is-2">
                <div class="select is-fullwidth">
                    <select name="rating">
                        <option value="">-- S·ªë sao --</option>
                        <option value="5" th:selected="${rating == 5}">5 sao</option>
                        <option value="4" th:selected="${rating == 4}">4 sao</option>
                        <option value="3" th:selected="${rating == 3}">3 sao</option>
                        <option value="2" th:selected="${rating == 2}">2 sao</option>
                        <option value="1" th:selected="${rating == 1}">1 sao</option>
                    </select>
                </div>
            </div>
            <div class="column is-2">
                <div class="select is-fullwidth">
                    <select name="sort">
                        <option value="">-- S·∫Øp x·∫øp --</option>
                        <option value="desc" th:selected="${sort == 'desc'}">Sao gi·∫£m d·∫ßn</option>
                        <option value="asc" th:selected="${sort == 'asc'}">Sao tƒÉng d·∫ßn</option>
                    </select>
                </div>
            </div>
            <div class="column is-2">
                <button class="button is-info is-fullwidth" type="submit">L·ªçc</button>
            </div>
        </form>

        <br/>

        <!-- B·∫£ng nh·∫≠t k√Ω -->
        <table class="table is-fullwidth is-striped is-hoverable">
            <thead>
            <tr>
                <th>Ng√†y</th>
                <th>Ti√™u ƒë·ªÅ</th>
                <th>Ho·∫°t ƒë·ªông</th>
                <th>Chi ti√™u</th>
                <th>ƒê·ªãa ƒëi·ªÉm</th>
                <th>ƒêi c√πng</th>
                <th>Ghi ch√∫</th>
                <th>C·∫£m x√∫c</th>
                <th>Thao t√°c</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="diary : ${diaries}">
                <td th:text="${diary.date}">2025-06-26</td>
                <td th:text="${diary.title}">Ti√™u ƒë·ªÅ</td>
                <td th:text="${diary.activity}">Ho·∫°t ƒë·ªông</td>
                <td th:text="${diary.amount} + ' vnƒë'">0 vnƒë</td>
                <td th:text="${diary.location}">ƒê·ªãa ƒëi·ªÉm</td>
                <td>
                    <ul>
                        <li th:each="p : ${diary.participants}" th:text="${p}">Ng∆∞·ªùi ƒëi c√πng</li>
                    </ul>
                </td>
                <td th:text="${diary.notes}">Ghi ch√∫</td>
                <td class="emoji" th:text="${diary.feeling}">‚ù§Ô∏è</td>
                <td class="stars">
                    <span th:each="i : ${#numbers.sequence(1, 5)}"
                          th:text="${i <= diary.rating ? '‚òÖ' : '‚òÜ'}"
                          th:classappend="${i <= diary.rating} ? 'has-text-warning' : ''">‚òÖ</span>
                </td>
                <td>
                    <a th:href="@{'/diaries/' + ${userId} + '/edit/' + ${diary.id}}" class="button is-small is-info">S·ª≠a</a>
                    <a th:href="@{'/diaries/' + ${userId} + '/delete/' + ${diary.id}}"
                       class="button is-small is-danger"
                       onclick="return confirm('B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a?')">X√≥a</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</section>
</body>
</html>
